<html>
    <head>
        <title>Login</title>
    <link rel="stylesheet" href="loginsignin.css">
    <link rel="icon" type="image/png" href="../images/logo.png">
    </head>
    <body>
        <div class="main-h">
            <div class="header">
                <a href="#"><div class="logo">
                    <img src="./images/logo.png" alt="Valorant Basics Logo">
                    <a href="#">Valorant ProHub</a>
                </div></a>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="1.html">Agents</a></li>
                        <li><a href="maps.html">Maps</a></li>
                        <li><a href="weapons.html">Weapons</a></li>
                        <li><a href="lineups.html">Lineups</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="container">
            <div class="card">
                    <div class="login-card card-side active-card">
                        <h1>Login</h1>
                        <form method="post" action="/loginForm" id="loginForm">
                            <input type="text" placeholder="Username" required id="username">
                            <input type="password" placeholder="Password" required id="password">
                            <a href="#" class="forgot-password" onclick="showForget()">Forgot Password?</a>
                            <input type="submit" id="submit" value="Log In">
                        </form>
                        <p>Don't have an account? <a href="#" onclick="showSignUp()">Sign Up</a></p>
                    </div>
    
                    <!-- Sign Up Form -->
                    <div class="signup-card card-side">
                        <h1>Sign Up</h1>
                        <form method="POST" action="/signinForm" id="signinForm">
                            <input type="text" placeholder="Full Name" required id="user_name">
                            <input type="email" placeholder="Email" required id="uemail">
                            <input type="number" placeholder="number" required id="phnumber">
                            <input type="password" placeholder="Password" required id="user_password">
                            <input type="text" placeholder="Your favourite thing in Valorant" required id="recovery">
                            <p><b>Note:-</b>This will help you to recreate your password</p>
                            
                            <input type="submit" id="submit" value="Sign Up" onclick="showLogin()">
                        </form>
                        <p>Already have an account? <a href="#" onclick="showLogin()">Login</a></p>
                    </div>

                    
                    <div class="forget-card card-side">
                        <h1>Forget Password</h1>
                        <form method="POST" action="/forgetForm" id="forgetForm">
                            <input type="text" placeholder="Username" required id="uname">
                            <input type="text" placeholder="Your favourite thing in Valorant" required id="precovery">
                            <input type="password" placeholder="Password" required id="upassword">
                            
                            <input type="submit" id="submit" value="Change Password" onclick="showLogin()">
                        </form>
                        <p>Remember the password? <a href="#" onclick="showLogin()">Login</a></p>
                    </div>
            </div>
        </div>
        <div class="footer">
            <img src="./images/logo.png">
            <p>Â© 2024, Valorant ProHub</p>
        </div>
        <script src="/database.js"></script>
        <script>
            function showLogin() {
            document.querySelector('.login-card').classList.add('active-card');
            document.querySelector('.signup-card').classList.remove('active-card');
            document.querySelector('.forget-card').classList.remove('active-card');
        }

        function showSignUp() {
            document.querySelector('.signup-card').classList.add('active-card');
            document.querySelector('.login-card').classList.remove('active-card');
            document.querySelector('.forget-card').classList.remove('active-card');
        }

        function showForget() {
            document.querySelector('.forget-card').classList.add('active-card');
            document.querySelector('.login-card').classList.remove('active-card');
            document.querySelector('.signup-card').classList.remove('active-card');
        }


        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById("loginForm");
            
            form.addEventListener("submit", function (event) {
                event.preventDefault(); 

                const username = document.getElementById("username").value;
                const password = document.getElementById("password").value;

                localStorage.setItem('isLoggedIn', true);

                fetch("http://localhost:6161/loginForm", {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify({ username, password }),
                })
                .then((response) => response.json())
                .then((data) => {
                  if (data.success) {
                    alert("Login Successful!");
                    localStorage.setItem('isLoggedIn', true);
                    localStorage.setItem('userName', data.userName);
                    window.location.href = `/index`;
                  } else {
                    alert("Error: " + data.message);
                  }
                })
                .catch((error) => console.error("Error:", error));
            });
        });

        document.addEventListener('DOMContentLoaded', function () {
              const form = document.getElementById('signinForm');
          
              form.addEventListener('submit', function (event) {
                event.preventDefault();
          
                const uname = document.getElementById('user_name').value;
                const uemail = document.getElementById('uemail').value;
                const npassword = document.getElementById('user_password').value;
                const phnumber = document.getElementById('phnumber').value;
                const recovery = document.getElementById('recovery').value;
          
                fetch('http://localhost:6161/signinForm', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({ uname, uemail, npassword, phnumber, recovery }),
                })
                .then((response) => response.json())
                .then((data) => {
                  if (data.success) {
                    alert('Sign up successful!');
                    form.reset(); 
                  } else {
                    alert('Error: ' + data.message);
                  }
                })
                .catch((error) => console.error('Error:', error));
              });
            });


        document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("forgetForm");
        
        form.addEventListener("submit", function (event) {
            event.preventDefault();
            
            const name = document.getElementById("uname").value;
            const upassword = document.getElementById("upassword").value;
            const precovery = document.getElementById("precovery").value;

            fetch("http://localhost:6161/forgetForm", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ name, upassword, precovery }),
            })
              .then((response) => response.json())
              .then((data) => {
                if (data.success) {
                  alert("Login Successfully");
                } else {
                  alert("Error: " + data.message);
                }
              })
              .catch((error) => console.error("Error:", error));
            });
        });
        </script>
    </body>
</html>